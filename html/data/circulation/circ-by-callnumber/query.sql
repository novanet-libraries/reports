SELECT CALLNUMBER,
  :PERIOD,
  CASE Z35_EVENT_TYPE
    WHEN '50' THEN 'LOAN'
    WHEN '52' THEN 'LOAN'
    WHEN '91' THEN 'LOAN'
    WHEN '62' THEN 'RENEWAL'
    WHEN '63' THEN 'RENEWAL'
    WHEN '64' THEN 'RENEWAL'
    WHEN '71' THEN 'HOLD'
    WHEN '72' THEN 'HOLD'
    WHEN '73' THEN 'HOLD'
    WHEN '74' THEN 'HOLD'
    WHEN '81' THEN 'PHOTOCOPY'
    WHEN '80' THEN 'RESHELF'
    WHEN '82' THEN 'RESHELF'
    WHEN '90' THEN 'BOOKING'
  END AS EVENT
 FROM NOV50.Z35
 JOIN WEBREPORT.ITEM_RECORDS ON Z30_REC_KEY = Z35_REC_KEY || LPAD(Z35_ITEM_SEQUENCE,6,'0')
WHERE SUB_LIBRARY IN ( :SUBLIBRARIES )
  :ANDCN
  AND RTRIM(Z35_SUB_LIBRARY) IN ( :SUBLIBRARIES )
  AND Z35_EVENT_DATE BETWEEN :STARTDATE AND :ENDDATE
  AND Z35_EVENT_TYPE IN ('50', '52', '62', '63', '64', '71', '72', '73', '74', '80', '81', '82', '90', '91')
