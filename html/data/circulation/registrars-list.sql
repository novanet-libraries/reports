SELECT Z303_HOME_LIBRARY, Z305_EXPIRY_DATE, Z303_NAME, AMOUNT, BARCODE, INST_ID
  FROM NOV50.Z303
  JOIN NOV50.CASH_OWING_PER_PATRON CASH
    ON CASH.USER_ID = Z303_REC_KEY
  LEFT OUTER JOIN NOV50.Z305
    ON Z303_REC_KEY || Z303_HOME_LIBRARY = Z305_REC_KEY
  LEFT OUTER JOIN NOV50.PATRON_IDS IDS
    ON IDS.USER_ID = Z303_REC_KEY
 WHERE RTRIM(Z303_HOME_LIBRARY) = :SUBLIBRARY
   AND Z305_BOR_STATUS IN ('01','02','03','28','29','32','35','37','42','44','48','53','62','70','82','85','96','97','98')
   AND CASH.AMOUNT <> 0
