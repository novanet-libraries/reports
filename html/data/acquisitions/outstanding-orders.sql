SELECT
  RTRIM(Z76_BUDGET_NUMBER) BUDGET_NUMBER,
  Z76_NAME BUDGET_NAME,
  Z68_ISBN ISBN,
  Z68_ORDER_NUMBER ORDER_NUMBER,
  Z68_ORDER_DATE ORDER_DATE,
  Z68_TOTAL_PRICE TOTAL_PRICE,
  Z68_VENDOR_CODE VENDOR_CODE
FROM NOV50.Z601
JOIN NOV50.Z76 ON RTRIM(SUBSTR(Z601_REC_KEY,1,50)) = RTRIM(Z76_BUDGET_NUMBER)
JOIN NOV50.Z68 ON Z601_REC_KEY_3 = Z68_REC_KEY
WHERE RTRIM(Z68_ORDERING_UNIT) = :ORDERUNIT
AND SUBSTR(RTRIM(Z76_BUDGET_NUMBER),-4) = :BUDGETYEAR
AND Z601_TYPE = 'ENC'
