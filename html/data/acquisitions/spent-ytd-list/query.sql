--SELECT * FROM WEBREPORT.SPENTYEARTODATE WHERE RTRIM(Z76_BUDGET_NUMBER) IN ( :BUDGETNUMBERS )
SELECT SPENTYEARTODATE.*, CALLNUMBER
FROM WEBREPORT.SPENTYEARTODATE
LEFT OUTER JOIN (
  SELECT ADM_NUMBER, MAX(CALLNUMBER) AS CALLNUMBER
  FROM WEBREPORT.ITEM_RECORDS
  GROUP BY ADM_NUMBER
) ON SUBSTR(Z68_TO_Z103,6,9) = ADM_NUMBER
WHERE RTRIM(Z76_BUDGET_NUMBER) IN ( :BUDGETNUMBERS )
